<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>District Line Tracker</title>
    <meta name="description" content="Report and track delays on the District Line Wimbledon branch. Community evidence for better service.">
    <meta name="theme-color" content="#00843D">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='none' stroke='%23E32017' stroke-width='12'/><rect x='5' y='38' width='90' height='24' fill='%23003688'/><text x='50' y='54' font-family='Arial,sans-serif' font-size='10.5' fill='white' text-anchor='middle' font-weight='bold'>WIMBLEDON</text></svg>">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <header class="header">
        <div class="header-inner">
            <h1>District Line Tracker <span class="line-badge">WIMBLEDON</span></h1>
        </div>
    </header>

    <nav class="nav">
        <div class="nav-inner">
            <a href="index.html" class="active">Report</a>
            <a href="feed.html">Feed</a>
            <a href="dashboard.html">Dashboard</a>
        </div>
    </nav>

    <main class="container">

        <!-- Live TfL status + intro -->
        <div class="banner">
            <h2>Help us track District Line problems</h2>
            <p>Report delays, cancellations, and issues on the Wimbledon branch. Your reports build evidence for change.</p>
            <div id="tfl-live-status" class="tfl-status good" style="display: none;">
                <span class="pulse"></span>
                <span id="tfl-status-text">Checking TfL status...</span>
            </div>
        </div>

        <!-- Report form -->
        <form id="report-form" class="card">
            <div class="card-title">Submit a Report</div>

            <div class="form-row">
                <div class="form-group">
                    <label for="incident_date">Date</label>
                    <input type="date" id="incident_date" name="incident_date" required min="2026-01-01">
                </div>
                <div class="form-group">
                    <label for="incident_time">Time</label>
                    <input type="time" id="incident_time" name="incident_time" required>
                </div>
            </div>

            <div class="form-group">
                <label for="station">Station</label>
                <select id="station" name="station" required>
                    <option value="">Select station...</option>
                    <option value="Wimbledon">Wimbledon</option>
                    <option value="Wimbledon Park">Wimbledon Park</option>
                    <option value="Southfields">Southfields</option>
                    <option value="East Putney">East Putney</option>
                    <option value="Putney Bridge">Putney Bridge</option>
                    <option value="Parsons Green">Parsons Green</option>
                    <option value="Fulham Broadway">Fulham Broadway</option>
                    <option value="West Brompton">West Brompton</option>
                    <option value="Earls Court">Earls Court</option>
                </select>
            </div>

            <div class="form-group">
                <label for="direction">Direction of travel</label>
                <select id="direction" name="direction" required>
                    <option value="">Select direction...</option>
                    <option value="Eastbound (towards Earls Court)">Eastbound (towards Earls Court)</option>
                    <option value="Westbound (towards Wimbledon)">Westbound (towards Wimbledon)</option>
                    <option value="Both / General">Both / General</option>
                </select>
            </div>

            <div class="form-group">
                <label for="category">Type of issue</label>
                <select id="category" name="category" required>
                    <option value="">Select category...</option>
                    <option value="General Delays">General Delays</option>
                    <option value="Signal Failure">Signal Failure</option>
                    <option value="Overcrowding">Overcrowding</option>
                    <option value="Train Cancellation">Train Cancellation</option>
                    <option value="Reduced Service">Reduced Service</option>
                    <option value="No Announcements / Poor Comms">No Announcements / Poor Comms</option>
                    <option value="Safety Concern">Safety Concern</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="delay_minutes">Estimated delay (minutes)</label>
                <p class="hint">How long were you delayed? Leave blank if unsure.</p>
                <input type="number" id="delay_minutes" name="delay_minutes" min="0" max="120" placeholder="e.g. 5">
            </div>

            <div class="form-group">
                <label for="description">What happened?</label>
                <p class="hint">Describe the issue — what you saw, heard, or experienced.</p>
                <textarea id="description" name="description" rows="3" placeholder="e.g. Waited 5 mins at Wimbledon Park, no announcements, train was standing room only..."></textarea>
            </div>

            <div class="form-group">
                <label for="reporter_name">Your name (optional)</label>
                <input type="text" id="reporter_name" name="reporter_name" placeholder="Anonymous">
            </div>

            <!-- Rate limit notice -->
            <div id="rate-limit-notice" class="rate-limit-notice"></div>

            <button type="submit" id="submit-btn" class="btn btn-primary">
                Submit Report
            </button>

            <!-- Discrepancy note: shown after submission if TfL says "Good Service" -->
            <div id="discrepancy-note" class="discrepancy-note" style="display: none;"></div>
        </form>

    </main>

    <div class="site-footer">
        <div class="footer-section">
            <h4>What we hope to show</h4>
            <p>This project exists to document the real experience of commuters on the District Line Wimbledon branch and hold TfL accountable for the service they provide. Specifically, we aim to show that TfL's own status reports frequently say "Good Service" when commuters are experiencing significant delays, cancellations, and overcrowding. By collating timestamped reports alongside TfL's live API data, we can demonstrate these discrepancies with hard evidence — and present that evidence to our local MP, TfL, and the Department for Transport to push for the signalling upgrades and investment this line desperately needs.</p>
        </div>
        <div class="footer-section" style="background: #EDF4FE; border: 1px solid #BDD5F5;">
            <h4 style="color: #1A56A8;">Why we need community data</h4>
            <p style="color: #3A5F8F;">TfL used to measure the impact of delays using a metric called <strong>Lost Customer Hours</strong>, which estimated the time lost by passengers due to disruptions of two minutes or more. However, TfL stopped publishing this data after period 12 of 2019/20 — citing changes in passenger demand due to COVID. They have never resumed reporting it, even as ridership has returned to near pre-pandemic levels.</p>
            <p style="color: #3A5F8F;">This means there is currently <strong>no official measure</strong> of the real-world impact of delays on commuters. This tracker exists to fill that gap — giving Wimbledon branch passengers a way to record and quantify the time they lose, so we can present hard evidence to our MP and TfL.</p>
            <p style="color: #3A5F8F; font-size: 11px; font-style: italic; opacity: 0.8; margin-top: 8px;">Source: <a href="https://tfl.gov.uk/corporate/publications-and-reports/underground-services-performance" target="_blank" rel="noopener" style="color: #3A5F8F;">TfL Underground Services Performance</a></p>
        </div>
        <div class="footer-section">
            <h4>Your data and privacy</h4>
            <p>Your name will only be displayed on reports if you choose to include it — by doing so, you give us permission to show it publicly on this site. If you leave the name field blank, your report appears as "Anonymous". We only collect and store the information you submit (station, time, delay, description) for the sole purpose of collating evidence to improve District Line service and increase investment. We do not share your data with third parties or use it for any other purpose. All data may be included in reports shared with your local MP and TfL.</p>
        </div>
        <div class="footer-section" style="text-align: center;">
            <p>Built by Wimbledon branch commuters. TfL status via <a href="https://tfl.gov.uk/info-for/open-data-users/" target="_blank" rel="noopener">TfL Open Data</a>.</p>
            <p style="margin-top: 8px;"><a href="mailto:districtlinetracker@gmail.com?subject=Suggestion%20for%20District%20Line%20Tracker">Suggest an improvement to this app</a></p>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script src="js/app.js"></script>
</body>
</html>
